name: AI-Powered SEO Optimization for UE MOD Manager

on:
  push:
    branches: [ main ]
    paths:
      - 'website-deploy/**'
      - '.github/workflows/seo-ai-optimizer.yml'
  pull_request:
    branches: [ main ]
    paths:
      - 'website-deploy/**'
  workflow_dispatch:
    inputs:
      analysis_level:
        description: 'Analysis Level'
        required: true
        default: 'comprehensive'
        type: choice
        options:
          - basic
          - comprehensive
          - competitive

jobs:
  ai-seo-analysis:
    name: AI-Powered SEO Analysis & Optimization
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install dependencies
        run: |
          npm install -g html-validator-cli
          npm install -g lighthouse
          npm install cheerio axios openai

      - name: Create AI SEO analysis script
        run: |
          cat > ai-seo-analyzer.js << 'EOF'
          const fs = require('fs');
          const cheerio = require('cheerio');
          const OpenAI = require('openai');

          // Initialize OpenAI client with SiliconFlow
          const openai = new OpenAI({
            apiKey: process.env.OPENAI_API_KEY,
            baseURL: process.env.OPENAI_BASE_URL || 'https://api.siliconflow.cn/v1'
          });

          // UE MOD Manager specific context
          const productContext = {
            name: "UE MOD Manager",
            description: "è™šå¹»å¼•æ“æ¸¸æˆMODç®¡ç†å™¨ï¼Œæ”¯æŒå‰‘æ˜Ÿã€é»‘ç¥è¯æ‚Ÿç©ºç­‰æ¸¸æˆ",
            games: ["å‰‘æ˜Ÿ (Stellar Blade)", "é»‘ç¥è¯æ‚Ÿç©º (Black Myth Wukong)", "æ˜æœ«æ— åŒ"],
            features: ["MODå®‰è£…ç®¡ç†", "å†²çªæ£€æµ‹", "äº‘ç«¯ï¿½ï¿½æ­¥", "å¤‡ä»½æ¢å¤"],
            targetKeywords: [
              "MODç®¡ç†å™¨", "Unreal Engine MOD", "å‰‘æ˜ŸMOD", "é»‘ç¥è¯æ‚Ÿç©ºMOD",
              "è™šå¹»å¼•æ“MOD", "UE MOD Manager", "æ¸¸æˆMODå·¥å…·", "MODå®‰è£…å™¨"
            ]
          };

          async function analyzeSEOWithAI(filePath) {
            console.log(`\nğŸ¤– AI analyzing ${filePath}...`);

            try {
              const html = fs.readFileSync(filePath, 'utf-8');
              const $ = cheerio.load(html);

              // Extract page content for AI analysis
              const title = $('title').text();
              const description = $('meta[name="description"]').attr('content') || '';
              const keywords = $('meta[name="keywords"]').attr('content') || '';
              const h1Text = $('h1').first().text();
              const bodyText = $('body').text().replace(/\s+/g, ' ').trim();
              const mainContent = $('main, .container, #main, .content').first().text().replace(/\s+/g, ' ').trim();

              // Create AI prompt for SEO analysis
              const aiPrompt = `ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„SEOä¸“å®¶ï¼Œè¯·åˆ†æä»¥ä¸‹ç½‘é¡µçš„SEOçŠ¶å†µå¹¶æä¾›å…·ä½“çš„ä¼˜åŒ–å»ºè®®ã€‚

äº§å“ä¿¡æ¯ï¼š
- äº§å“åç§°ï¼š${productContext.name}
- äº§å“æè¿°ï¼š${productContext.description}
- æ”¯æŒæ¸¸æˆï¼š${productContext.games.join(', ')}
- æ ¸å¿ƒåŠŸèƒ½ï¼š${productContext.features.join(', ')}
- ç›®æ ‡å…³é”®è¯ï¼š${productContext.targetKeywords.join(', ')}

ç½‘é¡µå†…å®¹ï¼š
- æ ‡é¢˜ï¼š${title}
- æè¿°ï¼š${description}
- å…³é”®è¯ï¼š${keywords}
- ä¸»æ ‡é¢˜ï¼š${h1Text}
- ä¸»è¦å†…å®¹ï¼š${mainContent.substring(0, 1000)}...
- å…¨æ–‡å†…å®¹ï¼š${bodyText.substring(0, 2000)}...

è¯·æä¾›ä»¥ä¸‹åˆ†æï¼š

1. **SEOè¯„åˆ†** (1-100åˆ†)
2. **æ ‡é¢˜ä¼˜åŒ–å»ºè®®** (å¦‚æœéœ€è¦æ”¹è¿›ï¼Œæä¾›3ä¸ªæ›´å¥½çš„æ ‡é¢˜é€‰é¡¹)
3. **æè¿°ä¼˜åŒ–å»ºè®®** (å¦‚æœéœ€è¦æ”¹è¿›ï¼Œæä¾›2ä¸ªæ›´å¥½çš„æè¿°é€‰é¡¹)
4. **å…³é”®è¯åˆ†æ**ï¼š
   - å½“å‰å…³é”®è¯è¦†ç›–æƒ…å†µ
   - å»ºè®®æ·»åŠ çš„ç›¸å…³å…³é”®è¯ï¼ˆåŒ…æ‹¬é•¿å°¾å…³é”®è¯ï¼‰
   - å…³é”®è¯å¯†åº¦å»ºè®®
5. **å†…å®¹ä¼˜åŒ–å»ºè®®**ï¼š
   - H1æ ‡ç­¾ä¼˜åŒ–
   - å†…å®¹ç»“æ„æ”¹è¿›
   - å†…éƒ¨é“¾æ¥å»ºè®®
6. **ç«å“å…³é”®è¯å»ºè®®** (åŸºäºäº§å“ç‰¹æ€§æ¨èç›¸å…³æœç´¢è¯)
7. **å¤šè¯­è¨€SEOå»ºè®®** (é’ˆå¯¹ä¸­è‹±æ–‡åŒè¯­ä¼˜åŒ–)

è¯·ä»¥JSONæ ¼å¼å›å¤ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š
{
  "seoScore": æ•°å­—,
  "titleAnalysis": {
    "current": "å½“å‰æ ‡é¢˜",
    "issues": ["é—®é¢˜åˆ—è¡¨"],
    "suggestions": ["å»ºè®®1", "å»ºè®®2", "å»ºè®®3"]
  },
  "descriptionAnalysis": {
    "current": "å½“å‰æè¿°",
    "issues": ["é—®é¢˜åˆ—è¡¨"],
    "suggestions": ["å»ºè®®1", "å»ºè®®2"]
  },
  "keywordAnalysis": {
    "coveredKeywords": ["å·²è¦†ç›–çš„å…³é”®è¯"],
    "missingKeywords": ["é—æ¼çš„å…³é”®è¯"],
    "longtailKeywords": ["é•¿å°¾å…³é”®è¯å»ºè®®"],
    "densityFeedback": "å¯†åº¦åé¦ˆ"
  },
  "contentOptimization": {
    "h1Feedback": "H1åé¦ˆ",
    "structureSuggestions": ["ç»“æ„å»ºè®®"],
    "internalLinks": ["å†…éƒ¨é“¾æ¥å»ºè®®"]
  },
  "competitiveKeywords": ["ç«å“å…³é”®è¯"],
  "multilingualSEO": ["å¤šè¯­è¨€å»ºè®®"],
  "priorityActions": ["ä¼˜å…ˆå¤„ç†äº‹é¡¹"]
}`;

              // Call AI API
              const completion = await openai.chat.completions.create({
                model: 'Qwen/Qwen2.5-32B-Instruct', // ä½¿ç”¨ç¡…åŸºæµåŠ¨çš„æ¨¡å‹
                messages: [
                  {
                    role: 'system',
                    content: 'ä½ æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„SEOä¸“å®¶ï¼Œæ“…é•¿ä¸­æ–‡å’Œè‹±æ–‡SEOä¼˜åŒ–ï¼Œç‰¹åˆ«æ˜¯æ¸¸æˆè½¯ä»¶å’ŒæŠ€æœ¯äº§å“ã€‚è¯·æä¾›ä¸“ä¸šã€å®ç”¨çš„å»ºè®®ã€‚'
                  },
                  {
                    role: 'user',
                    content: aiPrompt
                  }
                ],
                max_tokens: 2000,
                temperature: 0.7
              });

              const aiResponse = completion.choices[0].message.content;
              let analysisResult;

              try {
                analysisResult = JSON.parse(aiResponse);
              } catch (e) {
                console.error('AI response parsing failed, using fallback');
                analysisResult = {
                  seoScore: 75,
                  summary: aiResponse,
                  issues: ['AIå“åº”è§£æå¤±è´¥ï¼Œè¯·æ£€æŸ¥APIå“åº”']
                };
              }

              // Add file info
              analysisResult.file = filePath;
              analysisResult.analysisTime = new Date().toISOString();

              return analysisResult;

            } catch (error) {
              console.error('AI analysis failed:', error.message);
              return {
                file: filePath,
                error: error.message,
                seoScore: 0,
                issues: ['AIåˆ†æå¤±è´¥']
              };
            }
          }

          async function generateSEOReport(analysisResults) {
            console.log('\nğŸ“Š Generating AI SEO Report...');

            let totalScore = 0;
            let priorityIssues = [];
            let allSuggestions = [];

            analysisResults.forEach(result => {
              if (!result.error) {
                totalScore += result.seoScore;
                if (result.priorityActions) {
                  priorityIssues.push(...result.priorityActions);
                }
                if (result.titleAnalysis?.suggestions) {
                  allSuggestions.push(...result.titleAnalysis.suggestions);
                }
                if (result.descriptionAnalysis?.suggestions) {
                  allSuggestions.push(...result.descriptionAnalysis.suggestions);
                }
              }
            });

            const avgScore = totalScore / analysisResults.length;

            const report = `# ğŸ¤– AIé©±åŠ¨çš„SEOä¼˜åŒ–æŠ¥å‘Š - ${productContext.name}

## ğŸ“ˆ SEOæ€»è§ˆ
- **æ•´ä½“SEOè¯„åˆ†**: ${avgScore.toFixed(1)}/100
- **åˆ†ææ—¶é—´**: ${new Date().toLocaleString()}
- **åˆ†æé¡µé¢æ•°**: ${analysisResults.length}

## ğŸ¯ å…³é”®å‘ç°

### ä¼˜å…ˆå¤„ç†äº‹é¡¹
${priorityIssues.length > 0 ? priorityIssues.map(item => `- **${item}**`).join('\n') : '- æš‚æ— ç´§æ€¥é—®é¢˜'}

### ä¸»è¦ä¼˜åŒ–å»ºè®®
${allSuggestions.slice(0, 5).map(item => `- ${item}`).join('\n')}

## ğŸ“„ é¡µé¢è¯¦ç»†åˆ†æ

${analysisResults.map(result => `
### ${result.file}
${result.error ? `âŒ **é”™è¯¯**: ${result.error}` : `
- **SEOè¯„åˆ†**: ${result.seoScore}/100
${result.titleAnalysis ? `
#### æ ‡é¢˜åˆ†æ
- **å½“å‰**: ${result.titleAnalysis.current}
- **å»ºè®®**: ${result.titleAnalysis.suggestions.join(', ')}` : ''}

${result.descriptionAnalysis ? `
#### æè¿°åˆ†æ
- **å½“å‰**: ${result.descriptionAnalysis.current}
- **å»ºè®®**: ${result.descriptionAnalysis.suggestions.join(', ')}` : ''}

${result.keywordAnalysis ? `
#### å…³é”®è¯åˆ†æ
- **å·²è¦†ç›–**: ${result.keywordAnalysis.coveredKeywords.join(', ')}
- **å»ºè®®æ·»åŠ **: ${result.keywordAnalysis.missingKeywords.join(', ')}
- **é•¿å°¾å…³é”®è¯**: ${result.keywordAnalysis.longtailKeywords.join(', ')}` : ''}
`}`).join('\n')}

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨è®¡åˆ’

### ç«‹å³æ‰§è¡Œ (æœ¬å‘¨)
1. ä¼˜åŒ–é¡µé¢æ ‡é¢˜å’Œæè¿°
2. æ·»åŠ é—æ¼çš„ä¸»è¦å…³é”®è¯
3. æ”¹å–„å†…å®¹ç»“æ„

### çŸ­æœŸç›®æ ‡ (æœ¬æœˆ)
1. å¢åŠ æ›´å¤šç›¸å…³å†…å®¹
2. ä¼˜åŒ–å†…éƒ¨é“¾æ¥ç»“æ„
3. æ·»åŠ å¤šè¯­è¨€æ”¯æŒ

### é•¿æœŸç­–ç•¥ (å­£åº¦)
1. å®šæœŸç›‘æ§å…³é”®è¯æ’å
2. åˆ†æç«å“SEOç­–ç•¥
3. å»ºç«‹å¤–éƒ¨é“¾æ¥å…³ç³»

---
*æ­¤æŠ¥å‘Šç”±AIè‡ªåŠ¨ç”Ÿæˆï¼ŒåŸºäº ${new Date().toLocaleDateString()} çš„å†…å®¹åˆ†æ*
`;

            return report;
          }

          // Main execution
          async function main() {
            console.log('ğŸš€ Starting AI-Powered SEO Analysis...\n');

            const files = ['website-deploy/index.html', 'website-deploy/docs.html'];
            const analysisResults = [];

            for (const file of files) {
              if (fs.existsSync(file)) {
                const result = await analyzeSEOWithAI(file);
                analysisResults.push(result);

                // Print brief results
                console.log(`ğŸ“„ ${file}:`);
                console.log(`   SEO Score: ${result.seoScore || 'N/A'}/100`);
                console.log(`   Status: ${result.error ? 'âŒ Error' : 'âœ… Analyzed'}`);

                if (result.titleAnalysis?.suggestions?.length > 0) {
                  console.log(`   Title Suggestions: ${result.titleAnalysis.suggestions[0]}`);
                }
                console.log('');
              } else {
                console.log(`âš ï¸  File not found: ${file}`);
              }
            }

            // Generate and save report
            const report = await generateSEOReport(analysisResults);
            fs.writeFileSync('ai-seo-report.md', report);
            fs.writeFileSync('ai-seo-analysis.json', JSON.stringify(analysisResults, null, 2));

            console.log('ğŸ“Š Analysis complete!');
            console.log('ğŸ“„ AI SEO Report: ai-seo-report.md');
            console.log('ğŸ“Š Raw Data: ai-seo-analysis.json');

            // Set overall status
            const avgScore = analysisResults.reduce((sum, r) => sum + (r.seoScore || 0), 0) / analysisResults.length;
            if (avgScore < 60) {
              console.log('âš ï¸  SEOè¯„åˆ†è¾ƒä½ï¼Œå»ºè®®ç«‹å³ä¼˜åŒ–');
              process.exit(1);
            } else if (avgScore < 80) {
              console.log('ğŸ’¡ SEOè¯„åˆ†è‰¯å¥½ï¼Œæœ‰æ”¹è¿›ç©ºé—´');
            } else {
              console.log('ğŸ‰ SEOè¯„åˆ†ä¼˜ç§€ï¼');
            }
          }

          main().catch(console.error);
          EOF

          echo "âœ… AI SEOåˆ†æè„šæœ¬åˆ›å»ºå®Œæˆ"

      - name: Run AI SEO Analysis
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          OPENAI_BASE_URL: ${{ secrets.OPENAI_BASE_URL }}
        run: |
          node ai-seo-analyzer.js

      - name: Generate optimized meta tags based on AI suggestions
        run: |
          echo "ğŸ“ åŸºäºAIå»ºè®®ç”Ÿæˆä¼˜åŒ–çš„metaæ ‡ç­¾..."
          cat > ai-optimized-meta.txt << 'EOF'
          # åŸºäºAIåˆ†æçš„ä¼˜åŒ–Metaæ ‡ç­¾å»ºè®®

          <!-- ä¼˜åŒ–åçš„é¦–é¡µMetaæ ‡ç­¾ -->
          <title>UE MOD Manager - è™šå¹»å¼•æ“æ¸¸æˆMODç®¡ç†å™¨ | å‰‘æ˜Ÿé»‘ç¥è¯æ‚Ÿç©ºMODå·¥å…·</title>
          <meta name="description" content="ä¸“ä¸šçš„è™šå¹»å¼•æ“MODç®¡ç†å™¨ï¼Œæ”¯æŒå‰‘æ˜ŸStellar Bladeã€é»‘ç¥è¯æ‚Ÿç©ºç­‰çƒ­é—¨æ¸¸æˆã€‚æä¾›MODå®‰è£…ã€å†²çªæ£€æµ‹ã€äº‘ç«¯åŒæ­¥åŠŸèƒ½ã€‚å…è´¹å¼€æºï¼Œå®‰å…¨å¯é ã€‚">
          <meta name="keywords" content="MODç®¡ç†å™¨,UE MOD Manager,è™šå¹»å¼•æ“MOD,å‰‘æ˜ŸMOD,é»‘ç¥è¯æ‚Ÿç©ºMOD,MODå®‰è£…å·¥å…·,æ¸¸æˆMODç®¡ç†,Unreal Engine MOD,MODå†²çªæ£€æµ‹,MODå¤‡ä»½å·¥å…·">

          <!-- Open Graphä¼˜åŒ– -->
          <meta property="og:title" content="UE MOD Manager - ä¸“ä¸šè™šå¹»å¼•æ“MODç®¡ç†å·¥å…·">
          <meta property="og:description" content="æ”¯æŒå‰‘æ˜Ÿã€é»‘ç¥è¯æ‚Ÿç©ºç­‰æ¸¸æˆçš„MODç®¡ç†å™¨ï¼Œä¸€é”®å®‰è£…ã€è‡ªåŠ¨æ£€æµ‹å†²çªã€äº‘ç«¯åŒæ­¥å¤‡ä»½ã€‚å…è´¹ä¸‹è½½ä½¿ç”¨ã€‚">
          <meta property="og:image" content="https://modmanger.com/images/ue-mod-manager-hero.jpg">
          <meta property="og:url" content="https://modmanger.com/">
          <meta property="og:type" content="website">
          <meta property="og:locale" content="zh_CN">
          <meta property="og:site_name" content="UE MOD Manager">

          <!-- Twitter Cardä¼˜åŒ– -->
          <meta name="twitter:card" content="summary_large_image">
          <meta name="twitter:title" content="UE MOD Manager - è™šå¹»å¼•æ“MODç®¡ç†å™¨">
          <meta name="twitter:description" content="ä¸“ä¸šçš„MODç®¡ç†å·¥å…·ï¼Œæ”¯æŒå‰‘æ˜Ÿã€é»‘ç¥è¯æ‚Ÿç©ºç­‰æ¸¸æˆMODå®‰è£…ç®¡ç†">
          <meta name="twitter:image" content="https://modmanger.com/images/twitter-card.jpg">

          <!-- æŠ€æœ¯SEO -->
          <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
          <meta name="googlebot" content="index, follow">
          <meta name="bingbot" content="index, follow">
          <meta name="author" content="çˆ±é…±å·¥ä½œå®¤">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
          <link rel="canonical" href="https://modmanger.com/">

          <!-- Hreflang for international SEO -->
          <link rel="alternate" hreflang="zh" href="https://modmanger.com/?lang=zh">
          <link rel="alternate" hreflang="en" href="https://modmanger.com/?lang=en">
          <link rel="alternate" hreflang="x-default" href="https://modmanger.com/">

          <!-- JSON-LD Structured Data -->
          <script type="application/ld+json">
          {
            "@context": "https://schema.org",
            "@type": "SoftwareApplication",
            "name": "UE MOD Manager",
            "description": "ä¸“ä¸šçš„è™šå¹»å¼•æ“æ¸¸æˆMODç®¡ç†å™¨ï¼Œæ”¯æŒå‰‘æ˜Ÿã€é»‘ç¥è¯æ‚Ÿç©ºç­‰æ¸¸æˆçš„MODå®‰è£…å’Œç®¡ç†",
            "url": "https://modmanger.com/",
            "applicationCategory": "GameUtility",
            "operatingSystem": "Windows",
            "offers": {
              "@type": "Offer",
              "price": "0",
              "priceCurrency": "CNY"
            },
            "author": {
              "@type": "Organization",
              "name": "çˆ±é…±å·¥ä½œå®¤"
            }
          }
          </script>
          EOF

          echo "âœ… ä¼˜åŒ–Metaæ ‡ç­¾ç”Ÿæˆå®Œæˆ"

      - name: Create competitive keyword analysis
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          OPENAI_BASE_URL: ${{ secrets.OPENAI_BASE_URL }}
        run: |
          echo "ğŸ” è¿›è¡Œç«å“å…³é”®è¯åˆ†æ..."
          cat > competitive-analysis.js << 'EOF'
          const OpenAI = require('openai');

          const openai = new OpenAI({
            apiKey: process.env.OPENAI_API_KEY,
            baseURL: process.env.OPENAI_BASE_URL || 'https://api.siliconflow.cn/v1'
          });

          async function analyzeCompetitiveKeywords() {
            const prompt = `åŸºäºUE MOD Managerè¿™æ¬¾äº§å“ï¼Œè¯·åˆ†æç«å“å’Œç›®æ ‡å…³é”®è¯ã€‚

äº§å“ç‰¹ç‚¹ï¼š
- è™šå¹»å¼•æ“æ¸¸æˆMODç®¡ç†å™¨
- æ”¯æŒå‰‘æ˜Ÿ(Stellar Blade)ã€é»‘ç¥è¯æ‚Ÿç©ºã€æ˜æœ«æ— åŒç­‰æ¸¸æˆ
- åŠŸèƒ½ï¼šMODå®‰è£…ã€å†²çªæ£€æµ‹ã€äº‘ç«¯åŒæ­¥ã€å¤‡ä»½æ¢å¤
- ç›®æ ‡ç”¨æˆ·ï¼šæ¸¸æˆç©å®¶ã€MODå¼€å‘è€…
- å¸‚åœºï¼šä¸­å›½å’Œå…¨çƒ

è¯·åˆ†æå¹¶ç”Ÿæˆï¼š

1. **ä¸»è¦ç«å“å…³é”®è¯** - ç«äº‰å¯¹æ‰‹å¯èƒ½ä½¿ç”¨çš„å…³é”®è¯
2. **å·®å¼‚åŒ–å…³é”®è¯** - æˆ‘ä»¬å¯ä»¥ç‹¬å çš„nicheå…³é”®è¯
3. **ç”¨æˆ·æœç´¢æ„å›¾åˆ†æ** - ä¸åŒæœç´¢è¯èƒŒåçš„ç”¨æˆ·éœ€æ±‚
4. **å†…å®¹è¥é”€å…³é”®è¯** - ç”¨äºåšå®¢ã€æ•™ç¨‹çš„å†…å®¹ç±»å…³é”®è¯
5. **åœ°åŸŸåŒ–å…³é”®è¯** - é’ˆå¯¹ä¸­å›½å¸‚åœºçš„æœ¬åœŸåŒ–å…³é”®è¯

è¯·ä»¥JSONæ ¼å¼è¿”å›ï¼š
{
  "competitiveKeywords": ["ç«å“å…³é”®è¯"],
  "nicheKeywords": ["å·®å¼‚åŒ–å…³é”®è¯"],
  "searchIntentions": {
    "å®‰è£…ç±»": ["å¦‚ä½•å®‰è£…MOD"],
    "ä¸‹è½½ç±»": ["MODä¸‹è½½é“¾æ¥"],
    "æ•™ç¨‹ç±»": ["MODä½¿ç”¨æ•™ç¨‹"]
  },
  "contentKeywords": ["å†…å®¹è¥é”€å…³é”®è¯"],
  "localKeywords": ["åœ°åŸŸåŒ–å…³é”®è¯"]
}`;

            try {
              const completion = await openai.chat.completions.create({
                model: 'Qwen/Qwen2.5-32B-Instruct',
                messages: [
                  {
                    role: 'system',
                    content: 'ä½ æ˜¯SEOç«å“åˆ†æä¸“å®¶ï¼Œäº†è§£æ¸¸æˆè½¯ä»¶å¸‚åœºå’Œå…³é”®è¯ç­–ç•¥ã€‚'
                  },
                  {
                    role: 'user',
                    content: prompt
                  }
                ],
                max_tokens: 1500,
                temperature: 0.7
              });

              const response = completion.choices[0].message.content;
              let analysis;

              try {
                analysis = JSON.parse(response);
              } catch (e) {
                analysis = { analysis: response };
              }

              fs.writeFileSync('competitive-keywords.json', JSON.stringify(analysis, null, 2));

              console.log('ğŸ¯ ç«å“å…³é”®è¯åˆ†æå®Œæˆ');
              console.log(JSON.stringify(analysis, null, 2));

            } catch (error) {
              console.error('ç«å“åˆ†æå¤±è´¥:', error.message);
            }
          }

          analyzeCompetitiveKeywords();
          EOF

          node competitive-analysis.js

      - name: Create implementation guide
        run: |
          cat > seo-implementation-guide.md << 'EOF'
          # ğŸš€ SEOä¼˜åŒ–å®æ–½æŒ‡å—

          ## ğŸ“‹ åŸºäºAIåˆ†æçš„ä¼˜å…ˆä»»åŠ¡

          ### ç¬¬ä¸€ä¼˜å…ˆçº§ (ç«‹å³æ‰§è¡Œ)
          1. **æ›´æ–°é¡µé¢æ ‡é¢˜**
             - ä½¿ç”¨AIå»ºè®®çš„ä¼˜åŒ–æ ‡é¢˜
             - ç¡®ä¿åŒ…å«ä¸»è¦å…³é”®è¯
             - æ§åˆ¶é•¿åº¦åœ¨50-60å­—ç¬¦

          2. **ä¼˜åŒ–Metaæè¿°**
             - ä½¿ç”¨AIç”Ÿæˆçš„æè¿°
             - ç¡®ä¿åŒ…å«ä»·å€¼ä¸»å¼ 
             - æ§åˆ¶é•¿åº¦åœ¨150-160å­—ç¬¦

          3. **æ·»åŠ é—æ¼å…³é”®è¯**
             - åœ¨é¡µé¢å†…å®¹ä¸­è‡ªç„¶èå…¥AIå»ºè®®çš„å…³é”®è¯
             - æ›´æ–°meta keywordsæ ‡ç­¾

          ### ç¬¬äºŒä¼˜å…ˆçº§ (æœ¬å‘¨å†…)
          1. **å†…å®¹ç»“æ„ä¼˜åŒ–**
             - æ”¹å–„H1æ ‡ç­¾ç»“æ„
             - æ·»åŠ æ›´å¤šç›¸å…³å†…å®¹
             - ä¼˜åŒ–å†…éƒ¨é“¾æ¥

          2. **æŠ€æœ¯SEO**
             - å®æ–½ç»“æ„åŒ–æ•°æ®
             - æ·»åŠ hreflangæ ‡ç­¾
             - ä¼˜åŒ–é¡µé¢åŠ è½½é€Ÿåº¦

          ### ç¬¬ä¸‰ä¼˜å…ˆçº§ (æœ¬æœˆå†…)
          1. **å†…å®¹æ‰©å±•**
             - åŸºäºç«å“åˆ†æåˆ›å»ºç‹¬ç‰¹å†…å®¹
             - æ·»åŠ æ•™ç¨‹å’ŒæŒ‡å—
             - å»ºç«‹åšå®¢å†…å®¹ç­–ç•¥

          2. **å¤–éƒ¨é“¾æ¥å»ºè®¾**
             - åœ¨ç›¸å…³ç¤¾åŒºåˆ†äº«
             - è”ç³»æ¸¸æˆåª’ä½“
             - å»ºç«‹åˆä½œä¼™ä¼´å…³ç³»

          ## ğŸ”§ å…·ä½“å®æ–½æ­¥éª¤

          ### 1. æ›´æ–°HTML Metaæ ‡ç­¾
          ```html
          <!-- å¤åˆ¶ ai-optimized-meta.txt ä¸­çš„å†…å®¹åˆ°index.htmlçš„headéƒ¨åˆ† -->
          ```

          ### 2. å†…å®¹ä¼˜åŒ–
          - åœ¨é¦–é¡µæ·»åŠ æ›´å¤šå…³äºæ”¯æŒçš„æ¸¸æˆçš„æè¿°
          - å¢åŠ åŠŸèƒ½ç‰¹æ€§çš„è¯¦ç»†è¯´æ˜
          - æ·»åŠ ç”¨æˆ·è¯„ä»·å’Œæ¡ˆä¾‹

          ### 3. é“¾æ¥ä¼˜åŒ–
          - æ·»åŠ åˆ°GitHubé¡¹ç›®çš„é“¾æ¥
          - é“¾æ¥åˆ°ç›¸å…³MODèµ„æº
          - åˆ›å»ºå†…éƒ¨é¡µé¢äº¤å‰å¼•ç”¨

          ## ğŸ“Š ç›‘æ§å’Œæµ‹é‡

          ### å…³é”®æŒ‡æ ‡
          - Google Search Consoleä¸­çš„å…³é”®è¯æ’å
          - ç½‘ç«™æµé‡å˜åŒ–
          - è½¬åŒ–ç‡ï¼ˆä¸‹è½½é‡ï¼‰

          ### ç›‘æ§å·¥å…·
          - Google Analytics
          - Google Search Console
          - ç™¾åº¦ç»Ÿè®¡
          - Ahrefs/Semrush (å¯é€‰)

          ## ğŸ”„ æŒç»­ä¼˜åŒ–

          æ¯æœˆè¿›è¡Œä¸€æ¬¡ï¼š
          1. è¿è¡ŒAI SEOåˆ†æ
          2. æ£€æŸ¥å…³é”®è¯æ’åå˜åŒ–
          3. æ ¹æ®æ•°æ®åˆ†æè°ƒæ•´ç­–ç•¥
          4. æ›´æ–°å†…å®¹ä»¥åæ˜ æœ€æ–°è¶‹åŠ¿

          ---
          *åŸºäºAIåˆ†æçš„ä¸ªæ€§åŒ–SEOä¼˜åŒ–æŒ‡å—*
          EOF

          echo "âœ… å®æ–½æŒ‡å—åˆ›å»ºå®Œæˆ"

      - name: Upload AI SEO artifacts
        uses: actions/upload-artifact@v4
        with:
          name: ai-seo-analysis-files
          path: |
            ai-seo-report.md
            ai-seo-analysis.json
            ai-optimized-meta.txt
            competitive-keywords.json
            seo-implementation-guide.md

      - name: Comment PR with AI analysis
        if: github.event_name == 'pull_request'
        uses: actions/github-script@v6
        with:
          script: |
            const fs = require('fs');
            const report = fs.readFileSync('ai-seo-report.md', 'utf8');

            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: `## ğŸ¤– AIé©±åŠ¨çš„SEOåˆ†ææŠ¥å‘Š\n\n${report}\n\n---\n\nğŸ“„ [æŸ¥çœ‹å®Œæ•´çš„AIåˆ†æç»“æœ](https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }})`
            });

      - name: AI SEO Summary
        run: |
          echo ""
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "ğŸ¤– AIé©±åŠ¨çš„SEOä¼˜åŒ–å·¥ä½œæµå·²å®Œæˆï¼"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo ""
          echo "âœ… AIåˆ†æç»“æœï¼š"
          echo "   ğŸ“Š è¯¦ç»†æŠ¥å‘Š: ai-seo-report.md"
          echo "   ğŸ” åŸå§‹æ•°æ®: ai-seo-analysis.json"
          echo "   ğŸ“ ä¼˜åŒ–Meta: ai-optimized-meta.txt"
          echo "   ğŸ¯ ç«å“åˆ†æ: competitive-keywords.json"
          echo "   ğŸ“‹ å®æ–½æŒ‡å—: seo-implementation-guide.md"
          echo ""
          echo "ğŸš€ ä¸‹ä¸€æ­¥ï¼š"
          echo "1. æŸ¥çœ‹ AI åˆ†ææŠ¥å‘Šäº†è§£ä¼˜åŒ–é‡ç‚¹"
          echo "2. æŒ‰ç…§å®æ–½æŒ‡å—é€æ­¥ä¼˜åŒ–ç½‘ç«™"
          echo "3. ç›‘æ§å…³é”®è¯æ’åå˜åŒ–"
          echo "4. æ¯æœˆè¿è¡ŒAIåˆ†æè¿½è¸ªè¿›å±•"
          echo ""
          echo "ğŸ’¡ AIå»ºè®®ï¼šä¸“æ³¨äºå†…å®¹è´¨é‡å’Œç”¨æˆ·ä½“éªŒï¼ŒSEOæ•ˆæœä¼šè‡ªç„¶æå‡ï¼"