<Window x:Class="UEModManager.Views.SupabaseConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Supabase配置向导" 
        Height="450" 
        Width="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize" Style="{StaticResource DarkFlatWindow}">
    <Window.CommandBindings>
        <CommandBinding Command="{x:Static SystemCommands.MinimizeWindowCommand}" Executed="OnMinimizeWindow" />
        <CommandBinding Command="{x:Static SystemCommands.MaximizeWindowCommand}" Executed="OnMaximizeWindow" />
        <CommandBinding Command="{x:Static SystemCommands.RestoreWindowCommand}" Executed="OnRestoreWindow" />
        <CommandBinding Command="{x:Static SystemCommands.CloseWindowCommand}" Executed="OnCloseWindow" />
    </Window.CommandBindings>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 标题 -->
        <TextBlock Grid.Row="0" 
                   Text="配置云端认证服务" 
                   FontSize="20" 
                   FontWeight="Bold" 
                   Margin="0,0,0,20"/>

        <!-- 演示模式选项 -->
        <Border Grid.Row="1" 
                Background="#FFF0F8FF" 
                BorderBrush="#FFB0C4DE" 
                BorderThickness="1" 
                CornerRadius="5" 
                Padding="15" 
                Margin="0,0,0,20">
            <StackPanel>
                <CheckBox x:Name="DemoModeCheckBox" 
                          Content="使用演示模式（无需配置，仅本地存储）" 
                          FontSize="14" 
                          FontWeight="SemiBold"
                          Click="DemoModeCheckBox_Click"/>
                <TextBlock Text="演示模式将使用本地数据库存储用户信息，不需要网络连接。" 
                           Margin="20,5,0,0" 
                           Foreground="Gray" 
                           TextWrapping="Wrap"/>
            </StackPanel>
        </Border>

        <!-- Supabase配置区域 -->
        <StackPanel Grid.Row="2">
            <TextBlock Text="Supabase配置（真实云端服务）" 
                       FontWeight="SemiBold" 
                       Margin="0,0,0,10"/>
            
            <!-- URL输入 -->
            <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" 
                           Text="项目URL：" 
                           VerticalAlignment="Center"/>
                <TextBox x:Name="UrlTextBox" 
                         Grid.Column="1" 
                         TextChanged="TextBox_TextChanged">
                    <TextBox.ToolTip>
                        <ToolTip>
                            <TextBlock>
                                格式：https://[your-project-id].supabase.co
                                <LineBreak/>
                                可以在Supabase控制台的Settings > API中找到
                            </TextBlock>
                        </ToolTip>
                    </TextBox.ToolTip>
                </TextBox>
            </Grid>

            <!-- Anon Key输入 -->
            <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" 
                           Text="Anon Key：" 
                           VerticalAlignment="Center"/>
                <TextBox x:Name="AnonKeyTextBox" 
                         Grid.Column="1"
                         TextChanged="TextBox_TextChanged">
                    <TextBox.ToolTip>
                        <ToolTip>
                            <TextBlock>
                                公开的匿名密钥（anon key）
                                <LineBreak/>
                                可以在Supabase控制台的Settings > API > Project API keys中找到
                            </TextBlock>
                        </ToolTip>
                    </TextBox.ToolTip>
                </TextBox>
            </Grid>

            <!-- 测试按钮 -->
            <Button x:Name="TestButton" 
                    Content="测试连接" 
                    Width="100" 
                    HorizontalAlignment="Left" 
                    Click="TestButton_Click"
                    Margin="120,0,0,0"/>
        </StackPanel>

        <!-- 说明文字 -->
        <Border Grid.Row="3" 
                Background="#FFFFF8DC" 
                BorderBrush="#FFD2691E" 
                BorderThickness="1" 
                CornerRadius="5" 
                Padding="15" 
                Margin="0,20,0,20">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <TextBlock Text="如何获取Supabase配置？" 
                               FontWeight="SemiBold" 
                               Margin="0,0,0,10"/>
                    <TextBlock TextWrapping="Wrap">
                        1. 访问 https://supabase.com 并创建免费账号
                        <LineBreak/>
                        2. 创建新项目（New Project）
                        <LineBreak/>
                        3. 等待项目初始化完成
                        <LineBreak/>
                        4. 进入 Settings → API
                        <LineBreak/>
                        5. 复制 Project URL 和 anon public key
                        <LineBreak/>
                        <LineBreak/>
                        <Run FontWeight="SemiBold">注意：</Run>如果您不需要云端同步功能，可以直接使用演示模式。
                    </TextBlock>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- 状态显示 -->
        <TextBlock x:Name="StatusTextBlock" 
                   Grid.Row="4" 
                   Text="请选择使用模式" 
                   Foreground="Gray" 
                   Margin="0,0,0,10"/>

        <!-- 按钮区域 -->
        <StackPanel Grid.Row="5" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right">
            <Button x:Name="SaveButton" 
                    Content="保存配置" 
                    Width="100" 
                    Click="SaveButton_Click" 
                    IsDefault="True"
                    Margin="0,0,10,0"/>
            <Button x:Name="CancelButton" 
                    Content="取消" 
                    Width="100" 
                    Click="CancelButton_Click" 
                    IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>
